<mat-menu
  #menu="matMenu">
  <span *ngFor="let child of children">
    <ng-container
      *ngIf="child.children?.length; else noChildren">
      <app-menu-item
        [item]="child"
        [children]="child.children">
      </app-menu-item>
    </ng-container>

    <ng-template #noChildren>
      <button mat-menu-item>
        {{ child.name }}
      </button>
    </ng-template>
  </span>
</mat-menu>

<button
  mat-menu-item
  [matMenuTriggerFor]="menu">
  {{ item?.name }}
</button>
